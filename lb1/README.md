## Анализ образца вируса

**Источник:** `/Samples/Families/PurpleFox/Samples`
**Дата образца:** 2025/07/10

### Ключевой функционал


**Ассемблерный код:**
```asm
push    1               ; bHibernate
call    SetSuspendState
```
Вирус использует функцию `SetSuspendState` для принудительного перевода компьютера в режим гибернации.
```
`push    6               ; uFlags`
`push    80000000h       ; dwReason`
`call    ExitWindowsEx`
```
Вызывает принудительный выход/выключение системы без запроса пользователя.

`push    80000h`
`push    100000h`
`push    40000h`
`push    200000h`
Программа выделяет огромные блоки (0.5–2 МБ) и полностью забивает их _memset.

`push "Software\\WinRAR\\General"`
`call RegOpenKeyExW`
`call RegQueryValueExW`
`push "rar -ioff"`
`push "Software\\WinRAR\\Paths"`
`push "AppData"`
Открывает системные ключи WinRAR, читает пути AppData.

`push 604h`
`push 0`
`push offset word_483908`
`call memset`
Строит структуру физированного размера, похоже на внутреннюю таблицу.

`mul edx`
`seto cl`
`neg ecx`
`or ecx, eax`
Генерирует непредсказуемые размеры буферов (зависит от переполнений).

В итоге вирус получает пути к AppData и другим системным папкам, а затем создает архивы, вероятно предназначенные для дальнейшей отправки злоумышленнику. Код программы сильно обфусцирован: он использует огромные буферы, динамическую распаковку и очистку памяти, что указывает на встроенный криптер и попытки скрыть истинную функциональность. Дополнительно вирус содержит проверку хэша, которая, вероятно, активирует скрытую часть вредоносных функций. Также в нём присутствуют вызовы для выключения или усыпления системы, что используется для сокрытия следов или применения изменений после перезагрузки.
